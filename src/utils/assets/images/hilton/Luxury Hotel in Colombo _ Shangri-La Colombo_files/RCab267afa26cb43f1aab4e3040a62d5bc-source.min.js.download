// For license information, see `https://assets.adobedtm.com/fcbfc0c56646/ca0aca81d51c/cbd82315d870/RCab267afa26cb43f1aab4e3040a62d5bc-source.js`.
_satellite.__registerScript('https://assets.adobedtm.com/fcbfc0c56646/ca0aca81d51c/cbd82315d870/RCab267afa26cb43f1aab4e3040a62d5bc-source.min.js', "<script>\n (function () {\n    function sojernAppend(src, onload) {\n        var dom = document.createElement('script');\n        dom.type = 'text/javascript';\n        dom.async = true;\n        dom.src = src;\n        dom.onload = onload;\n        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dom);\n    }\n\n    const sojernScripts = ['https://static.sojern.com/utils/sjrn_autocx.js', 'https://static.sojern.com/cip/hasher.js'];\n    let sojernScriptsLoaded = 0;\n\n    for (var key in sojernScripts) {\n        sojernAppend(sojernScripts[key], function () {\n            sojernScriptsLoaded++;\n            tracksojern(true);\n        });\n    }\n\n    const PAGE_TYPE = {\n        SLECT_ROOM_PC: 'SLECT_ROOM_PC',\n        SLECT_ROOM_MOBILE: 'SLECT_ROOM_MOBILE',\n        GUESTINFO_PC: 'GUESTINFO_PC',\n        GUESTINFO_MOBILE: 'GUESTINFO_MOBILE',\n        CONFIRM_RESERVATION_PC: 'CONFIRM_RESERVATION_PC',\n        CONFIRM_RESERVATION_MOBILE: 'CONFIRM_RESERVATION_MOBILE',\n        OTHER: 'OTHER'\n    };\n\n    \n    \n\n    function getPageType() {\n        const path = location.pathname;\n\n        if (/\\/reservations\\/select-room-rate(\\/)?$/.test(path)) {\n            return window.__pageData ? PAGE_TYPE.SLECT_ROOM_PC : PAGE_TYPE.SLECT_ROOM_MOBILE;\n        } else if (/\\/touch\\/hotel-detail(\\/)?$/.test(path)) {\n            return PAGE_TYPE.SLECT_ROOM_MOBILE;\n        } else if (/\\/reservations\\/check-out(\\/)?$/.test(path)) {\n            return window.__pageData ? PAGE_TYPE.GUESTINFO_PC : PAGE_TYPE.GUESTINFO_MOBILE;\n        } else if (/\\/touch\\/booking(\\/)?$/.test(path)) {\n            return PAGE_TYPE.GUESTINFO_MOBILE;\n        } else if (/\\/reservations\\/confirm-reservation(\\/)?$/.test(path)) {\n            return window.__pageData ? PAGE_TYPE.CONFIRM_RESERVATION_PC : PAGE_TYPE.CONFIRM_RESERVATION_MOBILE;\n        } else if (/\\/touch\\/reservation-result(\\/)?$/.test(path)) {\n            return PAGE_TYPE.CONFIRM_RESERVATION_MOBILE;\n        } else {\n            return PAGE_TYPE.OTHER;\n        }\n    }\n\n\n    function priceFormat(number) {\n\n        if (/,/.test(String(number))) {\n            return number;\n        }\n\n        var re = /\\d{1,3}(?=(\\d{3})+$)/g;\n        return (number + '').replace(/^(\\d+)((\\.\\d+)?)$/, function(s, s1, s2) { return s1.replace(re, \"$&,\") + s2; });\n    }\n\n\n    function getGuestinfoPrice(pageType) {\n      \n        // hp为现金总价，ffl为用户实付积分\n        let result = {\n            hp: 0,\n            ffl: 0\n        };\n\n        try {\n            if (pageType === PAGE_TYPE.GUESTINFO_PC) {\n                if (document.querySelector('#js-use-cash-point') && document.querySelector('#js-use-cash-point').checked) {\n                    result.hp = document.querySelector('.charge-cash-point .cash-amount').innerText.match(/\\d+(,?\\d+)?(\\.\\d+)?/g)[0];\n                    result.ffl = document.querySelector('.charge-cash-point  .point > input').value.match(/\\d+(,?\\d+)?(\\.\\d+)?/g)[0];\n                } else if (document.querySelector('#js-charge-info .charge-total  .total-item .text-right > div')) {\n                    let userPrice = document.querySelector('#js-charge-info .charge-total  .total-item .text-right > div').innerText.match(/\\d+(,?\\d+)?(\\.\\d+)?/g)[0]\n                    if(window.__pageData && window.__pageData.queryObj.redeemType === \"RedeemPoints\") {\n                        result.ffl = userPrice;\n                    } else {\n                        result.hp = userPrice;\n                    }\n                   \n                }\n            } else {\n                if (document.querySelector('.price-part > div.total-price > div.money')) {\n                    result.hp = document.querySelector('.price-part > div.total-price > div.money').innerText.match(/\\d+(,?\\d+)?(\\.\\d+)?/g)[0];\n                }\n                if (document.querySelector('.price-part > div.total-price > div.point-count')) {\n                    result.ffl = document.querySelector('.price-part > div.total-price > div.point-count').innerText.match(/\\d+(,?\\d+)?(\\.\\d+)?/g)[0];\n                }\n            }\n            \n        } catch (error) {}\n       \n\n        return result;\n    }\n\n    function getReservationBaseParams() {\n        return {\n            hd1: _satellite.getVar('SearchCheckInDate') || '',\n            hd2: _satellite.getVar('SearchCheckOutDate') || '',\n            hr: _satellite.getVar('RoomQty') || '',\n            hcu: _satellite.cookie.get('DefaultCurrency') || '', // 待确认，币种\n            t: parseInt(_satellite.getVar('AdultQty') || 0) + parseInt(_satellite.getVar('ChildrenQty') || 0)\n        };\n    }\n\n    function getConfirmReservationParams(pageType) {\n        let result = {};\n        try {\n            const sojern = pageType === PAGE_TYPE.CONFIRM_RESERVATION_PC ?\n                (window.__pageData && window.__pageData.sojern || {}) :\n                (window.__sojernData__ && window.__sojernData__ || {});\n\n            result = {\n                hd1: sojern.checkInDate || '',\n                hd2: sojern.checkOutDate || '',\n                hr: sojern.roomNum || '',\n                t: sojern.traveler,\n                hcu: 'USD', // 币种写死，totalCost为后端转的USD价格\n                hp: sojern.totalCost && String(sojern.totalCost).replaceAll(',', ''), // 后端转的USD价格\n                ffl: 0, // hp为订单总价格，已经包括了积分部分，因此积分传0\n                hconfno: sojern.bookingId || ''\n            };\n        } catch (error) { }\n\n        return result;\n        \n    }\n\n\n    function getPageParams() {\n        let result = {};\n       \n        try {\n            const pageType = getPageType();\n            switch (pageType) {\n            case PAGE_TYPE.SLECT_ROOM_PC:\n            case PAGE_TYPE.SLECT_ROOM_MOBILE:\n                result = getReservationBaseParams();\n                break;\n            case PAGE_TYPE.GUESTINFO_PC:\n            case PAGE_TYPE.GUESTINFO_MOBILE:\n                result = Object.assign({}, getReservationBaseParams(), getGuestinfoPrice(pageType));\n                break;\n            case PAGE_TYPE.CONFIRM_RESERVATION_MOBILE:\n            case PAGE_TYPE.CONFIRM_RESERVATION_PC:\n                result = getConfirmReservationParams(pageType);\n                break;\n            default:\n                break;\n            }\n\n            if (result.hp) {\n                result.hp = priceFormat(result.hp);\n            }\n    \n            if (result.ffl) {\n                result.ffl = priceFormat(result.ffl);\n            }\n\n        } catch (error) {}\n    \n\n        return result;\n\n    }\n\n    let lastTrackPage;\n    const needDelayTrack = [PAGE_TYPE.SLECT_ROOM_MOBILE, PAGE_TYPE.GUESTINFO_MOBILE, PAGE_TYPE.CONFIRM_RESERVATION_MOBILE];\n    const DELAY_TIME = 2000;\n\n    function tracksojern(delay, customParams = {}) {\n        if (sojernScriptsLoaded == sojernScripts.length) {\n            lastTrackPage = location.pathname;\n            \n            const pageType = getPageType();\n            if ((pageType === PAGE_TYPE.CONFIRM_RESERVATION_MOBILE || pageType === PAGE_TYPE.CONFIRM_RESERVATION_PC) && (!wa || !wa.Products)) {\n                return;\n            }\n\n            function track(){\n                try {\n                    let params = Object.assign({}, sjrn_params,\n                        {\n                            auto_eml: '',\n                            auto_eml_count: 0,\n                            auto_eml_list: '',\n                            auto_eml_domain: '',\n                            pc: location.href,\n                            auto_url: location.href\n                        },\n                        getPageParams(),\n                        customParams\n                    );\n                    var cid = [];\n                    var paramsArr = [];\n                    var cidParams = [];\n                    var pl = document.createElement('iframe');\n                    var defaultParams = { 'vid': 'hot' };\n                    for (let key in defaultParams) {\n                        params[key] = defaultParams[key];\n                    }\n                    for (let key in cidParams) {\n                        cid.push(params[cidParams[key]]);\n                    }\n                    params.cid = cid.join('|');\n                    for (let key in params) { paramsArr.push(key + '=' + encodeURIComponent(params[key])) };\n                    pl.type = 'text/html';\n                    pl.setAttribute('style', 'height:0; width: 0; display:none;');\n                    pl.async = true;\n                    pl.src = 'https://static.sojern.com/cip/a/882.html?f_v=v6_js&p_v=4&' + paramsArr.join('&');\n                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(pl);\n                } catch (e) {}\n            }\n\n\n            if (delay && needDelayTrack.includes(pageType)) {\n                // 单页应用，数据为异步的\n                setTimeout(function() {\n                    track();\n                }, DELAY_TIME);\n            } else {\n                track();\n            }\n\n        }\n    }\n\n    document.body.onclick = function (e) {\n        try {\n            switch (getPageType()) {\n            case PAGE_TYPE.SLECT_ROOM_PC:\n                if (/js-booking-room/.test(e.target.className)) {\n                    tracksojern();\n                }\n                break;\n            case PAGE_TYPE.SLECT_ROOM_MOBILE:\n                if (/price-booking-button|booking-btn/.test(e.target.parentNode.parentNode.parentNode.className)) {\n                    tracksojern();\n                }\n                break;\n            case PAGE_TYPE.GUESTINFO_PC:\n                if (/js-booking-btn/.test(e.target.className)) {\n                    tracksojern();\n                }\n                break;\n            case PAGE_TYPE.GUESTINFO_MOBILE:\n                if (/submit-btn/.test(e.target.className)) {\n                    tracksojern();\n                }\n                break;\n            default:\n                break;\n            }\n            \n        } catch (error) { }\n        \n    };\n\n    \n    const _wr = function(type) {\n        const orig = history[type];\n        return function() {\n            const rv = orig.apply(this, arguments);\n            const e = new Event(type);\n            e.arguments = arguments;\n            window.dispatchEvent(e);\n            return rv;\n        };\n    };\n\n    history.pushState = _wr('pushState');\n   \n    window.addEventListener('popstate', function() {\n        if(lastTrackPage !== location.pathname) {\n            tracksojern(true);\n        }\n        \n    });\n\n    window.addEventListener('pushState', function() {\n        if(lastTrackPage !== location.pathname) {\n            tracksojern(true);\n        }\n    });\n   \n})();\n</script>");